window.addEventListener('DOMContentLoaded', () => {
	const menu = document.querySelector('.header-wrap__contacts'),
	/*menuItem = document.querySelectorAll('.menu__list-item'),*/
	hamburger = document.querySelector('.hamburger');

	hamburger.addEventListener('click', () => {
			hamburger.classList.toggle('active');
			menu.classList.toggle('active');
	});

});




$(document).ready(function() {

	/*Аккордеон*/
	$(".question__item").click(function() {
		$this = $(this),
		$this.hasClass("question__item-opened") ? ($this.removeClass("question__item-opened"),
		$this.find(".question__item-body").slideUp()) : ($this.addClass("question__item-opened"),
		$this.find(".question__item-body").slideDown())
	});

	/*Галерея картинок fancybox*/

	$(".gallery-main__thumb-wrap").fancybox({
    fixed : false,
    autoCenter : true
	});

	/*Анимация wow*/
	$(".about__wrap, .info-block__set, .lessons__text, .lessons__wrap, .gallery-main__wrap, .accordion").addClass("wow");




	/*Модальное окно*/

	$('[data-modal=consultation]').on("click", function(){
		$('.overlay, #consultation').fadeIn('slow');
	});

	$('.modal__close').on('click', function(){
			$('.overlay, #consultation, #thanks').fadeOut('slow');
	});

	$("#consultation-form").validate({
		rules: {
			name: {
				required: true,
				minlength: 2
			},
			email: {
				required: true,
				email: true,
			}
		},
		messages: {
			messageage: {
				required: "Пожалуйста, введите возраст ученика",
			},
			name: {
				required: "Пожалуйста, введите свое имя",
				minlength: jQuery.validator.format("Введите минимум 3 символа!")
			},
			email: {
				required: "Пожалуйста, введите свою почту",
				email: "Неправильно введен почтовый адрес"
			}
		}
	});

	$("#consultation-form").submit(function(evt) {
		evt.preventDefault();
		if($('.valid').length == 2){
			$.ajax({
				type: "POST",
			}).done(function() {
				$(this).find("input").val("");
				$('#consultation').fadeOut();
				$('.overlay, #thanks').fadeIn('slow');
				$('#consultation-form').trigger('reset');
		});
	};
		return false;
	});

});


/**/
$(document).ready(function() {

	/*Модальное окно*/

	
	$("#form-qu").validate({
		rules: {
			messageage: {
				required: true
			},
			name: {
				required: true,
				minlength: 2
			},
			email: {
				required: true,
				email: true,
			}
		},
		messages: {
			messageage: {
				required: "Пожалуйста, введите возраст ученика",
			},
			name: {
				required: "Пожалуйста, введите свое имя",
				minlength: jQuery.validator.format("Введите минимум 3 символа!")
			},
			email: {
				required: "Пожалуйста, введите свою почту",
				email: "Неправильно введен почтовый адрес"
			}
		}
	});



	$("#form-qu").submit(function(evt) {
		evt.preventDefault();
		if($('.valid').length >= 3){
			$.ajax({
				type: "POST",
			}).done(function() {
				$(this).find("input").val("");
				$('.overlay, #thanks').fadeIn('slow');
				$('#form-qu').trigger('reset');
		});
	};
		return false;
	});





});



const TOKEN = '1968477113:AAGkA1hAn4oaQqKDnVnz80puHjb9pqAhlSY';
const CHAT_ID = '-1001244032999';


var elementsList = document.querySelectorAll("#form-qu, #consultation-form");
var form = [...elementsList];

form.addEventListener('submit', function (e) {
	e.preventDefault();
	data = new FormData(this);
	sendMsg(data);
})


function sendMsg(data) {
	var url = 'https://api.telegram.org/bot' + TOKEN + '/sendMessage'; // токен бота
	var body = JSON.stringify({
		chat_id: CHAT_ID,
		parse_mode: 'Markdown',
		text: '*Заявка с сайта*\n' + '\n\n*Имя:* ' + data.get("name") + '\n*E-mail:* ' + data.get("email") + '\n*Взрослый/ребенок:* ' + data.get("radio1") + '\n*Возраст:* ' + data.get("messageage") + '\n*Стиль:* ' + data.get("radio2") + '\n*Уровень знаний:* ' + data.get("radio3") + '\n*Комментарий:* ' + data.get("message") + '\n*Откуда:* [' + window.location.href + '](' + window.location.href + ')'
	});
	var xhr = new XMLHttpRequest();
	xhr.open('POST', url, true);
	xhr.setRequestHeader('Content-type', 'application/json; charset=utf-8');
	xhr.send(body);
}
